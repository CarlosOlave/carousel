function Carousel(){this.create=function(){var exception=initialize();if(exception!==null){alert(exception)}exception=detectBrowser();if(exception!==null){alert(exception)}exception=createReflectiveElements();if(exception!==null){alert(exception)}exception=setCarouselViewMode();if(exception!==null){alert(exception)}};this.refresh=function(mode){if(mode===null||mode===undefined||mode==""||mode==m_currentCarouselMode){return null}m_currentCarouselMode=mode;setCarouselViewMode()};var initialize=function(){try{m_carousel=document.getElementsByClassName("carousel")[0];m_createReflection=m_carousel.getAttribute("data-reflection");m_createReflection=m_createReflection==="true";m_currentCarouselMode=m_carousel.getAttribute("data-mode");if(m_currentCarouselMode===undefined||m_currentCarouselMode===null){m_currentCarouselMode="cylinder"}m_backgroundColor=m_carousel.getAttribute("data-reflection-color");if(m_backgroundColor===undefined||m_backgroundColor===null){m_backgroundColor="rgba(74,86,100)"}m_carousel.addEventListener("click",throttle(function(event){if(event.target!==event.currentTarget){var parentItem=event.target.parentElement;var parentIndex=parentItem.getAttribute("data-index");transformationHandler(parentItem,parentIndex)}event.stopPropagation()},300),false);return null}catch(e){return e}};var createReflectiveElements=function(){try{imageCollection=document.getElementsByClassName("image-container");if(m_createReflection===true){for(var i=0;i<imageCollection.length;i++){var imageContainer=imageCollection[i];imageContainer.setAttribute("data-index",i);var imgEl=imageContainer.firstElementChild;var srcImage=imgEl.getAttribute("src");var reflectionContainer=document.createElement("div");reflectionContainer.className="reflection-container";var reflectionGradient=document.createElement("div");reflectionGradient.className="before";reflectionGradient.style["box-shadow"]="inset "+m_backgroundColor+" 0 186px 65px";var reflectionImg=document.createElement("img");reflectionImg.setAttribute("src",srcImage);reflectionContainer.appendChild(reflectionGradient);reflectionContainer.appendChild(reflectionImg);imageContainer.appendChild(reflectionContainer)}}return null}catch(e){return e}};var setCarouselViewMode=function(){try{if(m_currentCarouselMode==="cylinder"){defaultCylinderTransformation()}else if(m_currentCarouselMode==="timeMachine"){defaultTimeMachineTransformation()}else if(m_currentCarouselMode==="coverFlow"){defaultCoverFlowTransformation()}return null}catch(e){return e}};var detectBrowser=function(){try{var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){m_attributePrefix="-webkit-"}if(M[1]==="Chrome"){m_attributePrefix=""}else if(M[1]==="Safari"){m_attributePrefix="-webkit-"}else if(M[1]==="Firefox"){m_attributePrefix="-moz-"}else{M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,"-?"];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);m_attributePrefix="-moz-"}return null}catch(e){return e}};var throttle=function(fn,delay){var timer=null;return function(){var context=this,args=arguments;clearTimeout(timer);timer=setTimeout(function(){fn.apply(context,args)},delay)}};var transformationHandler=function(el,index){if(m_currentCarouselMode==="cylinder"){m_carouselThetaY+=360/imageCollection.length;m_carousel.style[m_attributePrefix+"transform"]="translateZ("+m_carouselTranslateDeltaZ+"px) rotateX("+m_carouselRotateDeltaX+"deg) rotateY("+m_carouselThetaY+"deg)"}else if(m_currentCarouselMode==="timeMachine"){if(m_timeMachineForwardDirection===false){defaultTimeMachineTransformation()}else{var imageContainer=imageCollection[m_centerDisplayedImageIndex];imageContainer.style[m_attributePrefix+"transform"]="translateX( "+500+"px ) translateZ( "+1500+"px )";var timeMachineDeltaX=0;var timeMachineDeltaZ=439;for(var i=m_centerDisplayedImageIndex+1;i<imageCollection.length;i++){imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="translateX( "+timeMachineDeltaX+"px ) translateZ( "+timeMachineDeltaZ+"px )";timeMachineDeltaX-=100;timeMachineDeltaZ-=100}m_centerDisplayedImageIndex+=1;m_timeMachineForwardDirection=m_centerDisplayedImageIndex===imageCollection.length-1?false:m_centerDisplayedImageIndex===0?true:m_timeMachineForwardDirection}}else if(m_currentCarouselMode==="coverFlow"){if(m_timeMachineForwardDirection===false){defaultCoverFlowTransformation()}else{var degreeY=60;var defaultDeltaX=-530;var defaultDeltaZ=0;var imageContainer=null;for(var i=m_centerDisplayedImageIndex;i>=0;i--){imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="rotateY("+degreeY+"deg) translateZ("+defaultDeltaZ+"px) translateX("+defaultDeltaX+"px)";defaultDeltaZ-=100}imageContainer=imageCollection[m_centerDisplayedImageIndex+1];imageContainer.style[m_attributePrefix+"transform"]="rotateY("+0+"deg) translateZ("+430+"px) translateX("+0+"px)";degreeY=-60;defaultDeltaX=530;defaultDeltaZ=0;for(var i=m_centerDisplayedImageIndex+2;i<imageCollection.length;i++){imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="rotateY("+degreeY+"deg) translateZ("+defaultDeltaZ+"px) translateX("+defaultDeltaX+"px)";defaultDeltaZ-=100}m_centerDisplayedImageIndex+=1;m_timeMachineForwardDirection=m_centerDisplayedImageIndex===imageCollection.length-1?false:m_centerDisplayedImageIndex===0?true:m_timeMachineForwardDirection}}};var setDefaults=function(){try{m_carousel.style[m_attributePrefix+"transform"]="translateZ( -300px ) rotateX(0deg)";m_carouselRadius=Math.round(290/2/Math.tan(Math.PI/imageCollection.length));m_carouselRotateDeltaX=0;m_carouselTranslateDeltaZ=-300;m_carouselThetaY=0;m_centerDisplayedImageIndex=0;return null}catch(e){return e}};var defaultTimeMachineTransformation=function(){var exception=setDefaults();if(exception!==null){alert(exception)}var defaultDeltaX=0;var defaultDeltaZ=439;for(var i=0;i<imageCollection.length;i++){var imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="translateX( "+defaultDeltaX+"px ) translateZ( "+defaultDeltaZ+"px )";defaultDeltaX-=100;defaultDeltaZ-=100}m_timeMachineForwardDirection=true};var defaultCylinderTransformation=function(){var exception=setDefaults();if(exception!==null){alert(exception)}var degree=0;for(var i=0;i<imageCollection.length;i++){var imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="rotateY( "+degree+"deg ) translateZ( "+m_carouselRadius+"px )";degree+=360/imageCollection.length}};var defaultCoverFlowTransformation=function(){var exception=setDefaults();if(exception!==null){alert(exception)}var imageContainer=imageCollection[0];imageContainer.style[m_attributePrefix+"transform"]="rotateY("+0+"deg) translateZ("+430+"px) translateX("+0+"px)";var degreeY=-60;var defaultDeltaX=530;var defaultDeltaZ=0;for(var i=1;i<imageCollection.length;i++){imageContainer=imageCollection[i];imageContainer.style[m_attributePrefix+"transform"]="rotateY("+degreeY+"deg) translateZ("+defaultDeltaZ+"px) translateX("+defaultDeltaX+"px)";defaultDeltaZ-=100}m_timeMachineForwardDirection=true};var m_carouselRotateDeltaX=0;var m_carouselTranslateDeltaZ=-300;var m_carouselThetaY=0;var m_carouselRadius=0;var m_backgroundColor="rgb(74,86,100)";var m_attributePrefix=null;var m_currentCarouselMode="cylinder";var imageCollection=null;var m_centerDisplayedImageIndex=0;var m_timeMachineForwardDirection=true;var m_createReflection=false;var m_carousel=null}
